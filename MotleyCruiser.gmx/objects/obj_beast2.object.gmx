<!--This Document is generated by GameMaker, if you edit it by hand then you do so at your own risk!-->
<object>
  <spriteName>spr_hairbeast</spriteName>
  <solid>0</solid>
  <visible>-1</visible>
  <depth>0</depth>
  <persistent>0</persistent>
  <parentName>obj_enemy</parentName>
  <maskName>&lt;undefined&gt;</maskName>
  <events>
    <event eventtype="0" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// Init

/// Initialize enemy
type = 2;//enemy
depth = -y;

path = path_add();
target = noone;

//hunt, defend, hold
mode = "hunt";

hp=1000;
hp_current=hp;
pspeed = 2;
ospeed = pspeed;//original speed
image_speed = .25;
charge_mode=false;

health_y = sprite_get_height(sprite_index) + 5;
hyset = false;

weapon_index = noone;
weapon=noone;
race_index = noone;
sex = noone;

alarm[0] = room_speed;// Move and shoot

arms=noone; // Multiple weapons
weapon_offsets = noone;
weapon_offsets[0]="-24,-16";// x,y offsets
weapon_offsets[1]="24,-16";

start_x=x;
start_y=y;
teather = CELL_WIDTH * 5;
teather_cur = 0;

</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="1">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>if(pspeed&lt;ospeed+1){
    pspeed=ospeed+1;
}else{
    pspeed=ospeed-1;
}
alarm[1]=room_speed*3;
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// Move &amp; Shoot


var inview = scr_instance_in_view(self);

/***
Find closest member of the player's boarding team. This includes the player.
***/
if(instance_exists(obj_team)){    
    target = instance_nearest(x,y,obj_team);
    var px = (target.x div CELL_WIDTH)* CELL_WIDTH + CELL_WIDTH/2;
    var py = (target.y div CELL_HEIGHT)* CELL_HEIGHT + CELL_HEIGHT/2;
    var pd = distance_to_object(target);

}else{
    target = noone;
}

teather_cur = point_distance(x,y,start_x,start_y);
if( target!=noone &amp;&amp; instance_exists(target) ){
    
    // Get path to player
    scr_get_path_to_point(px,py,pspeed);
    
    var verse = direction div 180;
    if( (verse == 0 &amp;&amp; image_xscale&lt;0) || (verse == 1 &amp;&amp; image_xscale&gt;0) ){
        image_xscale *= -1;
    }
 
}

alarm[0] = room_speed;
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="3" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// Updates
depth = -y;

/// Equip weapon. Update weapon position and angle
var arm;
if(arms==noone){
    for(var i=0;i&lt;2;i++){
        arm = instance_create(x,y,obj_arm);
        arm.type = type;
        arm.parent_obj = id;
        arm.sprite_index = spr_beast2_arm;
        arm.depth = -10000;
        if(i==1){
            arm.image_yscale=-1;
        }
        arms[i]=arm;
        
    }
}

if(hp_current&lt;=hp*.50 &amp;&amp; !charge_mode){
    //Start charging routine
    charge_mode=true;
    alarm[1]=room_speed;
}

/// Check hp_current
if(hp_current&lt;1){

    scr_drop_loot();

    corpse = instance_create(x,y,obj_corpse);
    corpse.sprite = sprite_index;
    
    for(var i=0;i&lt;array_length_1d(arms);i++){
        arm=arms[i];
        with(arm){
            instance_destroy();
        }
    }
    arms=noone;
    instance_destroy();
}

if(arms != noone){
    var offsets;
    for(var i=0;i&lt;array_length_1d(arms);i++){
        offsets = scr_str_split(weapon_offsets[i],",");
        arm=arms[i];
        arm.x = x+real(offsets[0]);
        arm.y = y+real(offsets[1]);
        arm.depth = -10000;
        
        // Slower rotate
        if(target!=noone &amp;&amp; instance_exists(target)){
            var pdir = point_direction(arm.x, arm.y, target.x, target.y);
            var dif = angle_difference(pdir, arm.image_angle);
            arm.image_angle += median(-.5, dif,.5);      
        }
        
    }
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
  </events>
  <PhysicsObject>0</PhysicsObject>
  <PhysicsObjectSensor>0</PhysicsObjectSensor>
  <PhysicsObjectShape>0</PhysicsObjectShape>
  <PhysicsObjectDensity>0.5</PhysicsObjectDensity>
  <PhysicsObjectRestitution>0.100000001490116</PhysicsObjectRestitution>
  <PhysicsObjectGroup>0</PhysicsObjectGroup>
  <PhysicsObjectLinearDamping>0.100000001490116</PhysicsObjectLinearDamping>
  <PhysicsObjectAngularDamping>0.100000001490116</PhysicsObjectAngularDamping>
  <PhysicsObjectFriction>0.200000002980232</PhysicsObjectFriction>
  <PhysicsObjectAwake>-1</PhysicsObjectAwake>
  <PhysicsObjectKinematic>0</PhysicsObjectKinematic>
  <PhysicsShapePoints/>
</object>
