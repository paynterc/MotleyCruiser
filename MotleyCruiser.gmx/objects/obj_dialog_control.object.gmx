<!--This Document is generated by GameMaker, if you edit it by hand then you do so at your own risk!-->
<object>
  <spriteName>&lt;undefined&gt;</spriteName>
  <solid>0</solid>
  <visible>-1</visible>
  <depth>0</depth>
  <persistent>0</persistent>
  <parentName>&lt;undefined&gt;</parentName>
  <maskName>&lt;undefined&gt;</maskName>
  <events>
    <event eventtype="0" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// Init
show = false;
fly_conditionals=scr_array_size(10);
sent = noone;
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="3" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// Capture user response
/***
"sent" refers to the npc sending the message.
***/
if(scr_user_input("interact")){
    event_user(0);
}

if(scr_user_input("menu_close")){
    sent=noone;
    if(instance_exists(obj_flybox)){
        with(obj_flybox){
            destroy = true;
        }
    }
}

if(fly_conditionals!=noone){

    if(fly_conditionals[0]==1){
        fly_conditionals[0]=0;
        var bunks = obj_ship_data.bunks;
        
        if( obj_ship_data.bunks &lt;= scr_get_active_crew_count()+1 ){     
            scr_flywriter("You don't have enough bunks on your ship to hire more crew.",noone,0,"10,OK");
        }else{
            scr_add_npc_to_crew(sent);
        }
        sent=noone;
    }
    if(fly_conditionals[2]==1){
        
        fly_conditionals[2]=0;
        var repairCost = scr_repair_all_ship_cost();
        if(repairCost&lt;=global.credits || repairCost == 0 ){
            scr_repair_all_ships(repairCost);
            scr_flywriter("Thank you for your business. Your ships will be reapaired by the time you depart.",sent.sprite_index,true,"1,OK");
        }else{
            scr_flywriter("You can't afford it. Come back when you've earned enough credits.",sent.sprite_index,true,"1,OK");
        }
        

        sent=noone;
    }
    if(fly_conditionals[1]==1){
        fly_conditionals[1]=0;
        sent=noone;
    }
    if(fly_conditionals[9]==1){
        //Reserved for generic messages and error messages.
        fly_conditionals[9]=0;
        sent=noone;
    }      
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="7" enumb="10">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// Open dialogue

var this_sentient = noone;
var closest_range = 0;
var this_range = 0;
sent = noone;

for(var i = 0; i &lt; instance_number(obj_npc); i++) {
    this_sentient = instance_find(obj_npc,i);
    this_range = point_distance(obj_player.x,obj_player.y,this_sentient.x,this_sentient.y);
    var thisMode = this_sentient.mode;
    var thisNpc = this_sentient.npc_data;
    if(this_range&lt;50 &amp;&amp; this_sentient.mode == "discourse"){
        if(sent==noone){
            sent = this_sentient;
            closest_range = this_range;
        }else if(this_range&lt;closest_range){
            sent = this_sentient;
            closest_range = this_range;
        }
    }
}



if(sent != noone &amp;&amp; sent.name != noone){

    var occ;
    if(sent.npc_data[NPC_OCCUPATION]!=noone &amp;&amp; sent.npc_data[NPC_OCCUPATION]&lt;array_length_1d(global.npc_occupations)){
        occ = global.npc_occupations[sent.npc_data[NPC_OCCUPATION]];   
    }else{
        occ = noone;
    }


    if(sent.is_trader){
        
        scr_gui_set_context(obj_trade);
    
    }else if(sent.is_shipwright){
    
        var txt = "This individual goes by the name of " + sent.npc_data[NPC_NAME_FIRST] + " " + sent.npc_data[NPC_NAME_LAST] + ". ";   
        txt += sent.npc_data[NPC_NAME_FIRST] + " is a shipwright. Would like them to repair your ships? It will cost " + string(scr_repair_all_ship_cost()) + "C.";  
        scr_flywriter(txt,sent.sprite_index,true,"2,OK,Nope");
        
    }else if( scr_in_array(global.hirable_occupations,occ) ){
        
        var txt = "This individual goes by the name of " + sent.npc_data[NPC_NAME_FIRST] + " " + sent.npc_data[NPC_NAME_LAST] + ". ";   
        txt += sent.npc_data[NPC_NAME_FIRST] + " claims to be an excellent " + occ + ". Would like them to join your crew? It will cost " + string(sent.npc_data[NPC_HIRE_PRICE]) + "C per day.";  
        scr_flywriter(txt,sent.sprite_index,true,"0,OK,Nope");
        
                     
    }else{
    
        var txt = "Buzz off.";    
        scr_flywriter(txt,sent.sprite_index,true,"1,OK");    
    }
    
               
}



</string>
          </argument>
        </arguments>
      </action>
    </event>
  </events>
  <PhysicsObject>0</PhysicsObject>
  <PhysicsObjectSensor>0</PhysicsObjectSensor>
  <PhysicsObjectShape>0</PhysicsObjectShape>
  <PhysicsObjectDensity>0.5</PhysicsObjectDensity>
  <PhysicsObjectRestitution>0.100000001490116</PhysicsObjectRestitution>
  <PhysicsObjectGroup>0</PhysicsObjectGroup>
  <PhysicsObjectLinearDamping>0.100000001490116</PhysicsObjectLinearDamping>
  <PhysicsObjectAngularDamping>0.100000001490116</PhysicsObjectAngularDamping>
  <PhysicsObjectFriction>0.200000002980232</PhysicsObjectFriction>
  <PhysicsObjectAwake>-1</PhysicsObjectAwake>
  <PhysicsObjectKinematic>0</PhysicsObjectKinematic>
  <PhysicsShapePoints/>
</object>
